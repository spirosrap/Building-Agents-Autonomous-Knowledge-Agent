# Multi-Agent Architecture - ASCII Diagram

## System Overview

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           UDA-HUB MULTI-AGENT SYSTEM                        │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                              USER INTERFACE LAYER                           │
│                                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐  │
│  │   Web UI    │    │  Chat API   │    │  Mobile App │    │   Email     │  │
│  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘  │
│         │                   │                   │                   │      │
│         └───────────────────┼───────────────────┼───────────────────┘      │
│                             │                   │                          │
└─────────────────────────────┼───────────────────┼──────────────────────────┘
                              │                   │
                              ▼                   ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            SUPERVISOR LAYER                                 │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    SUPERVISOR AGENT                                │   │
│  │                                                                     │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │   │
│  │  │   Intent    │  │   Routing   │  │   Context   │  │  Response   │ │   │
│  │  │ Analysis    │  │   Logic     │  │ Management  │  │ Synthesis   │ │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    SHARED STATE                                    │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │   │
│  │  │Conversation │  │   User      │  │   System    │  │   Agent     │ │   │
│  │  │   State     │  │   State     │  │   State     │  │   State     │ │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         SPECIALIST AGENT LAYER                             │
│                                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │ Knowledge   │  │ Technical   │  │   Billing   │  │   Account   │        │
│  │   Base      │  │  Support    │  │   Agent     │  │ Management  │        │
│  │   Agent     │  │   Agent     │  │             │  │   Agent     │        │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘        │
│         │                   │                   │                   │      │
│         │                   │                   │                   │      │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   RAG       │  │  Database   │  │   Search    │  │   Action    │        │
│  │   Agent     │  │   Tools     │  │   Tools     │  │   Tools     │        │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘        │
└─────────────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              DATA LAYER                                    │
│                                                                             │
│  ┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐ │
│  │   Core Database     │  │  External Database  │  │   Knowledge Base    │ │
│  │   (Uda-hub)         │  │   (CultPass)        │  │   (Articles)        │ │
│  │                     │  │                     │  │                     │ │
│  │ ┌─────────────┐     │  │ ┌─────────────┐     │  │ ┌─────────────┐     │ │
│  │ │   Users     │     │  │ │Experiences  │     │  │ │Support       │     │ │
│  │ │   Tickets   │     │  │ │   Users     │     │  │ │Articles      │     │ │
│  │ │ Knowledge   │     │  │ │Reservations │     │  │ │Vector        │     │ │
│  │ │   etc.      │     │  │ │   etc.      │     │  │ │Embeddings    │     │ │
│  │ └─────────────┘     │  │ └─────────────┘     │  │ └─────────────┘     │ │
│  └─────────────────────┘  └─────────────────────┘  └─────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Agent Communication Flow

```
User Query
    │
    ▼
┌─────────────┐
│ Supervisor  │ ── Intent Analysis
│   Agent     │ ── Route Decision
└─────────────┘
    │
    ├─── Knowledge Request ──► ┌─────────────┐ ──► ┌─────────────┐
    │                         │ Knowledge   │     │   Search    │
    │                         │   Base      │     │   Tools     │
    │                         │   Agent     │     │             │
    │                         └─────────────┘     └─────────────┘
    │
    ├─── Technical Issue ─────► ┌─────────────┐ ──► ┌─────────────┐
    │                          │ Technical   │     │  Database   │
    │                          │  Support    │     │   Tools     │
    │                          │   Agent     │     │             │
    │                          └─────────────┘     └─────────────┘
    │
    ├─── Billing Issue ───────► ┌─────────────┐ ──► ┌─────────────┐
    │                          │   Billing   │     │  Database   │
    │                          │   Agent     │     │   Tools     │
    │                          └─────────────┘     └─────────────┘
    │
    ├─── Account Issue ───────► ┌─────────────┐ ──► ┌─────────────┐
    │                          │   Account   │     │  Database   │
    │                          │ Management  │     │   Tools     │
    │                          │   Agent     │     │             │
    │                          └─────────────┘     └─────────────┘
    │
    └─── Complex Query ───────► ┌─────────────┐
                                │ Multi-Agent │
                                │Consultation │
                                └─────────────┘
    │
    ▼
┌─────────────┐
│ Response    │ ── Synthesize Responses
│ Synthesis   │ ── Quality Check
└─────────────┘
    │
    ▼
User Response
```

## Decision Tree Flow

```
                    ┌─────────────────┐
                    │   User Query    │
                    │   Received      │
                    └─────────┬───────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │   Intent        │
                    │   Analysis      │
                    └─────────┬───────┘
                              │
                    ┌─────────┴───────┐
                    │                 │
                    ▼                 ▼
            ┌─────────────┐   ┌─────────────┐
            │   Simple    │   │   Complex   │
            │   Query     │   │   Query     │
            └─────────┬───┘   └──────┬──────┘
                      │              │
                      ▼              ▼
            ┌─────────────┐   ┌─────────────┐
            │ Single      │   │ Multi-Agent │
            │ Agent       │   │Consultation │
            └─────────┬───┘   └──────┬──────┘
                      │              │
                      ▼              ▼
            ┌─────────────┐   ┌─────────────┐
            │ Response    │   │ Response    │
            │ Generation  │   │ Synthesis   │
            └─────────┬───┘   └──────┬──────┘
                      │              │
                      └──────┬───────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │   Quality       │
                    │   Check         │
                    └─────────┬───────┘
                              │
                    ┌─────────┴───────┐
                    │                 │
                    ▼                 ▼
            ┌─────────────┐   ┌─────────────┐
            │   Pass      │   │   Fail      │
            └─────────┬───┘   └──────┬──────┘
                      │              │
                      ▼              ▼
            ┌─────────────┐   ┌─────────────┐
            │ Deliver     │   │ Request     │
            │ Response    │   │ Clarification│
            └─────────────┘   └─────────────┘
```

## State Management

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           SHARED STATE MANAGEMENT                          │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐
│  Conversation State │  │    User State       │  │   System State      │
│                     │  │                     │  │                     │
│ ┌─────────────────┐ │  │ ┌─────────────────┐ │  │ ┌─────────────────┐ │
│ │   Messages      │ │  │ │   User ID       │ │  │ │   Agent Status  │ │
│ │   Context       │ │  │ │   Preferences   │ │  │ │   Performance   │ │
│ │   Intent        │ │  │ │   History       │ │  │ │   Metrics       │ │
│ │   Agent         │ │  │ │   Permissions   │ │  │ │   Errors        │ │
│ └─────────────────┘ │  │ └─────────────────┘ │  │ └─────────────────┘ │
└─────────────────────┘  └─────────────────────┘  └─────────────────────┘
         │                        │                        │
         └────────────┬───────────┴───────────┬────────────┘
                      │                       │
                      ▼                       ▼
            ┌─────────────────┐    ┌─────────────────┐
            │   State         │    │   State         │
            │   Persistence   │    │   Synchronization│
            └─────────────────┘    └─────────────────┘
```

## Error Handling Flow

```
                    ┌─────────────────┐
                    │   Error         │
                    │   Detected      │
                    └─────────┬───────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │   Error Type    │
                    │   Classification│
                    └─────────┬───────┘
                              │
        ┌─────────────┬───────┴───────┬─────────────┐
        │             │               │             │
        ▼             ▼               ▼             ▼
┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│   Agent     │ │Communication│ │   Data      │ │   System    │
│   Failure   │ │   Failure   │ │   Failure   │ │   Failure   │
└─────────┬───┘ └──────┬──────┘ └──────┬──────┘ └──────┬──────┘
          │            │               │               │
          ▼            ▼               ▼               ▼
┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│ Restart     │ │ Re-establish│ │ Retry Data  │ │ System      │
│ Agent       │ │ Connection  │ │ Access      │ │ Restart     │
└─────────┬───┘ └──────┬──────┘ └──────┬──────┘ └──────┬──────┘
          │            │               │               │
          └────────────┴───────────────┴───────────────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │   Recovery      │
                    │   Successful?   │
                    └─────────┬───────┘
                              │
                    ┌─────────┴───────┐
                    │                 │
                    ▼                 ▼
            ┌─────────────┐   ┌─────────────┐
            │   Yes       │   │   No        │
            └─────────┬───┘   └──────┬──────┘
                      │              │
                      ▼              ▼
            ┌─────────────┐   ┌─────────────┐
            │ Continue    │   │ Escalate    │
            │ Processing  │   │ to Human    │
            └─────────────┘   └─────────────┘
```

This ASCII diagram provides a clear visual representation of the multi-agent architecture, showing the layers, components, and their relationships in a text-based format that can be easily shared and understood.
